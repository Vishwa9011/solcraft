/**
 * This code was AUTOGENERATED using the Codama library.
 * Please DO NOT EDIT THIS FILE, instead use visitors
 * to add features, then rerun Codama to update it.
 *
 * @see https://github.com/codama-idl/codama
 */

import {
   combineCodec,
   fixDecoderSize,
   fixEncoderSize,
   getAddressEncoder,
   getBytesDecoder,
   getBytesEncoder,
   getProgramDerivedAddress,
   getStructDecoder,
   getStructEncoder,
   transformEncoder,
   type AccountMeta,
   type AccountSignerMeta,
   type Address,
   type FixedSizeCodec,
   type FixedSizeDecoder,
   type FixedSizeEncoder,
   type Instruction,
   type InstructionWithAccounts,
   type InstructionWithData,
   type ReadonlyAccount,
   type ReadonlyUint8Array,
   type TransactionSigner,
   type WritableAccount,
   type WritableSignerAccount,
} from '@solana/kit';
import { SOLCRAFT_PROGRAM_ADDRESS } from '../programs';
import { expectAddress, getAccountMetaFactory, type ResolvedAccount } from '../shared';

export const INITIALIZE_FAUCET_DISCRIMINATOR = new Uint8Array([159, 109, 237, 214, 69, 231, 14, 60]);

export function getInitializeFaucetDiscriminatorBytes() {
   return fixEncoderSize(getBytesEncoder(), 8).encode(INITIALIZE_FAUCET_DISCRIMINATOR);
}

export type InitializeFaucetInstruction<
   TProgram extends string = typeof SOLCRAFT_PROGRAM_ADDRESS,
   TAccountFaucetConfig extends string | AccountMeta<string> = string,
   TAccountMint extends string | AccountMeta<string> = string,
   TAccountTreasuryAta extends string | AccountMeta<string> = string,
   TAccountOwner extends string | AccountMeta<string> = string,
   TAccountAssociatedTokenProgram extends string | AccountMeta<string> = 'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL',
   TAccountTokenProgram extends string | AccountMeta<string> = 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA',
   TAccountSystemProgram extends string | AccountMeta<string> = '11111111111111111111111111111111',
   TRemainingAccounts extends readonly AccountMeta<string>[] = [],
> = Instruction<TProgram> &
   InstructionWithData<ReadonlyUint8Array> &
   InstructionWithAccounts<
      [
         TAccountFaucetConfig extends string ? WritableAccount<TAccountFaucetConfig> : TAccountFaucetConfig,
         TAccountMint extends string ? ReadonlyAccount<TAccountMint> : TAccountMint,
         TAccountTreasuryAta extends string ? WritableAccount<TAccountTreasuryAta> : TAccountTreasuryAta,
         TAccountOwner extends string
            ? WritableSignerAccount<TAccountOwner> & AccountSignerMeta<TAccountOwner>
            : TAccountOwner,
         TAccountAssociatedTokenProgram extends string
            ? ReadonlyAccount<TAccountAssociatedTokenProgram>
            : TAccountAssociatedTokenProgram,
         TAccountTokenProgram extends string ? ReadonlyAccount<TAccountTokenProgram> : TAccountTokenProgram,
         TAccountSystemProgram extends string ? ReadonlyAccount<TAccountSystemProgram> : TAccountSystemProgram,
         ...TRemainingAccounts,
      ]
   >;

export type InitializeFaucetInstructionData = {
   discriminator: ReadonlyUint8Array;
};

export type InitializeFaucetInstructionDataArgs = {};

export function getInitializeFaucetInstructionDataEncoder(): FixedSizeEncoder<InitializeFaucetInstructionDataArgs> {
   return transformEncoder(getStructEncoder([['discriminator', fixEncoderSize(getBytesEncoder(), 8)]]), value => ({
      ...value,
      discriminator: INITIALIZE_FAUCET_DISCRIMINATOR,
   }));
}

export function getInitializeFaucetInstructionDataDecoder(): FixedSizeDecoder<InitializeFaucetInstructionData> {
   return getStructDecoder([['discriminator', fixDecoderSize(getBytesDecoder(), 8)]]);
}

export function getInitializeFaucetInstructionDataCodec(): FixedSizeCodec<
   InitializeFaucetInstructionDataArgs,
   InitializeFaucetInstructionData
> {
   return combineCodec(getInitializeFaucetInstructionDataEncoder(), getInitializeFaucetInstructionDataDecoder());
}

export type InitializeFaucetAsyncInput<
   TAccountFaucetConfig extends string = string,
   TAccountMint extends string = string,
   TAccountTreasuryAta extends string = string,
   TAccountOwner extends string = string,
   TAccountAssociatedTokenProgram extends string = string,
   TAccountTokenProgram extends string = string,
   TAccountSystemProgram extends string = string,
> = {
   faucetConfig?: Address<TAccountFaucetConfig>;
   mint: Address<TAccountMint>;
   treasuryAta?: Address<TAccountTreasuryAta>;
   owner: TransactionSigner<TAccountOwner>;
   associatedTokenProgram?: Address<TAccountAssociatedTokenProgram>;
   tokenProgram?: Address<TAccountTokenProgram>;
   systemProgram?: Address<TAccountSystemProgram>;
};

export async function getInitializeFaucetInstructionAsync<
   TAccountFaucetConfig extends string,
   TAccountMint extends string,
   TAccountTreasuryAta extends string,
   TAccountOwner extends string,
   TAccountAssociatedTokenProgram extends string,
   TAccountTokenProgram extends string,
   TAccountSystemProgram extends string,
   TProgramAddress extends Address = typeof SOLCRAFT_PROGRAM_ADDRESS,
>(
   input: InitializeFaucetAsyncInput<
      TAccountFaucetConfig,
      TAccountMint,
      TAccountTreasuryAta,
      TAccountOwner,
      TAccountAssociatedTokenProgram,
      TAccountTokenProgram,
      TAccountSystemProgram
   >,
   config?: { programAddress?: TProgramAddress }
): Promise<
   InitializeFaucetInstruction<
      TProgramAddress,
      TAccountFaucetConfig,
      TAccountMint,
      TAccountTreasuryAta,
      TAccountOwner,
      TAccountAssociatedTokenProgram,
      TAccountTokenProgram,
      TAccountSystemProgram
   >
> {
   // Program address.
   const programAddress = config?.programAddress ?? SOLCRAFT_PROGRAM_ADDRESS;

   // Original accounts.
   const originalAccounts = {
      faucetConfig: { value: input.faucetConfig ?? null, isWritable: true },
      mint: { value: input.mint ?? null, isWritable: false },
      treasuryAta: { value: input.treasuryAta ?? null, isWritable: true },
      owner: { value: input.owner ?? null, isWritable: true },
      associatedTokenProgram: {
         value: input.associatedTokenProgram ?? null,
         isWritable: false,
      },
      tokenProgram: { value: input.tokenProgram ?? null, isWritable: false },
      systemProgram: { value: input.systemProgram ?? null, isWritable: false },
   };
   const accounts = originalAccounts as Record<keyof typeof originalAccounts, ResolvedAccount>;

   // Resolve default values.
   if (!accounts.faucetConfig.value) {
      accounts.faucetConfig.value = await getProgramDerivedAddress({
         programAddress,
         seeds: [
            getBytesEncoder().encode(new Uint8Array([102, 97, 117, 99, 101, 116, 95, 99, 111, 110, 102, 105, 103])),
         ],
      });
   }
   if (!accounts.treasuryAta.value) {
      accounts.treasuryAta.value = await getProgramDerivedAddress({
         programAddress:
            'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL' as Address<'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL'>,
         seeds: [
            getAddressEncoder().encode(expectAddress(accounts.faucetConfig.value)),
            getBytesEncoder().encode(
               new Uint8Array([
                  6, 221, 246, 225, 215, 101, 161, 147, 217, 203, 225, 70, 206, 235, 121, 172, 28, 180, 133, 237, 95,
                  91, 55, 145, 58, 140, 245, 133, 126, 255, 0, 169,
               ])
            ),
            getAddressEncoder().encode(expectAddress(accounts.mint.value)),
         ],
      });
   }
   if (!accounts.associatedTokenProgram.value) {
      accounts.associatedTokenProgram.value =
         'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL' as Address<'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL'>;
   }
   if (!accounts.tokenProgram.value) {
      accounts.tokenProgram.value =
         'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA' as Address<'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA'>;
   }
   if (!accounts.systemProgram.value) {
      accounts.systemProgram.value = '11111111111111111111111111111111' as Address<'11111111111111111111111111111111'>;
   }

   const getAccountMeta = getAccountMetaFactory(programAddress, 'programId');
   return Object.freeze({
      accounts: [
         getAccountMeta(accounts.faucetConfig),
         getAccountMeta(accounts.mint),
         getAccountMeta(accounts.treasuryAta),
         getAccountMeta(accounts.owner),
         getAccountMeta(accounts.associatedTokenProgram),
         getAccountMeta(accounts.tokenProgram),
         getAccountMeta(accounts.systemProgram),
      ],
      data: getInitializeFaucetInstructionDataEncoder().encode({}),
      programAddress,
   } as InitializeFaucetInstruction<
      TProgramAddress,
      TAccountFaucetConfig,
      TAccountMint,
      TAccountTreasuryAta,
      TAccountOwner,
      TAccountAssociatedTokenProgram,
      TAccountTokenProgram,
      TAccountSystemProgram
   >);
}

export type InitializeFaucetInput<
   TAccountFaucetConfig extends string = string,
   TAccountMint extends string = string,
   TAccountTreasuryAta extends string = string,
   TAccountOwner extends string = string,
   TAccountAssociatedTokenProgram extends string = string,
   TAccountTokenProgram extends string = string,
   TAccountSystemProgram extends string = string,
> = {
   faucetConfig: Address<TAccountFaucetConfig>;
   mint: Address<TAccountMint>;
   treasuryAta: Address<TAccountTreasuryAta>;
   owner: TransactionSigner<TAccountOwner>;
   associatedTokenProgram?: Address<TAccountAssociatedTokenProgram>;
   tokenProgram?: Address<TAccountTokenProgram>;
   systemProgram?: Address<TAccountSystemProgram>;
};

export function getInitializeFaucetInstruction<
   TAccountFaucetConfig extends string,
   TAccountMint extends string,
   TAccountTreasuryAta extends string,
   TAccountOwner extends string,
   TAccountAssociatedTokenProgram extends string,
   TAccountTokenProgram extends string,
   TAccountSystemProgram extends string,
   TProgramAddress extends Address = typeof SOLCRAFT_PROGRAM_ADDRESS,
>(
   input: InitializeFaucetInput<
      TAccountFaucetConfig,
      TAccountMint,
      TAccountTreasuryAta,
      TAccountOwner,
      TAccountAssociatedTokenProgram,
      TAccountTokenProgram,
      TAccountSystemProgram
   >,
   config?: { programAddress?: TProgramAddress }
): InitializeFaucetInstruction<
   TProgramAddress,
   TAccountFaucetConfig,
   TAccountMint,
   TAccountTreasuryAta,
   TAccountOwner,
   TAccountAssociatedTokenProgram,
   TAccountTokenProgram,
   TAccountSystemProgram
> {
   // Program address.
   const programAddress = config?.programAddress ?? SOLCRAFT_PROGRAM_ADDRESS;

   // Original accounts.
   const originalAccounts = {
      faucetConfig: { value: input.faucetConfig ?? null, isWritable: true },
      mint: { value: input.mint ?? null, isWritable: false },
      treasuryAta: { value: input.treasuryAta ?? null, isWritable: true },
      owner: { value: input.owner ?? null, isWritable: true },
      associatedTokenProgram: {
         value: input.associatedTokenProgram ?? null,
         isWritable: false,
      },
      tokenProgram: { value: input.tokenProgram ?? null, isWritable: false },
      systemProgram: { value: input.systemProgram ?? null, isWritable: false },
   };
   const accounts = originalAccounts as Record<keyof typeof originalAccounts, ResolvedAccount>;

   // Resolve default values.
   if (!accounts.associatedTokenProgram.value) {
      accounts.associatedTokenProgram.value =
         'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL' as Address<'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL'>;
   }
   if (!accounts.tokenProgram.value) {
      accounts.tokenProgram.value =
         'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA' as Address<'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA'>;
   }
   if (!accounts.systemProgram.value) {
      accounts.systemProgram.value = '11111111111111111111111111111111' as Address<'11111111111111111111111111111111'>;
   }

   const getAccountMeta = getAccountMetaFactory(programAddress, 'programId');
   return Object.freeze({
      accounts: [
         getAccountMeta(accounts.faucetConfig),
         getAccountMeta(accounts.mint),
         getAccountMeta(accounts.treasuryAta),
         getAccountMeta(accounts.owner),
         getAccountMeta(accounts.associatedTokenProgram),
         getAccountMeta(accounts.tokenProgram),
         getAccountMeta(accounts.systemProgram),
      ],
      data: getInitializeFaucetInstructionDataEncoder().encode({}),
      programAddress,
   } as InitializeFaucetInstruction<
      TProgramAddress,
      TAccountFaucetConfig,
      TAccountMint,
      TAccountTreasuryAta,
      TAccountOwner,
      TAccountAssociatedTokenProgram,
      TAccountTokenProgram,
      TAccountSystemProgram
   >);
}

export type ParsedInitializeFaucetInstruction<
   TProgram extends string = typeof SOLCRAFT_PROGRAM_ADDRESS,
   TAccountMetas extends readonly AccountMeta[] = readonly AccountMeta[],
> = {
   programAddress: Address<TProgram>;
   accounts: {
      faucetConfig: TAccountMetas[0];
      mint: TAccountMetas[1];
      treasuryAta: TAccountMetas[2];
      owner: TAccountMetas[3];
      associatedTokenProgram: TAccountMetas[4];
      tokenProgram: TAccountMetas[5];
      systemProgram: TAccountMetas[6];
   };
   data: InitializeFaucetInstructionData;
};

export function parseInitializeFaucetInstruction<TProgram extends string, TAccountMetas extends readonly AccountMeta[]>(
   instruction: Instruction<TProgram> & InstructionWithAccounts<TAccountMetas> & InstructionWithData<ReadonlyUint8Array>
): ParsedInitializeFaucetInstruction<TProgram, TAccountMetas> {
   if (instruction.accounts.length < 7) {
      // TODO: Coded error.
      throw new Error('Not enough accounts');
   }
   let accountIndex = 0;
   const getNextAccount = () => {
      const accountMeta = (instruction.accounts as TAccountMetas)[accountIndex]!;
      accountIndex += 1;
      return accountMeta;
   };
   return {
      programAddress: instruction.programAddress,
      accounts: {
         faucetConfig: getNextAccount(),
         mint: getNextAccount(),
         treasuryAta: getNextAccount(),
         owner: getNextAccount(),
         associatedTokenProgram: getNextAccount(),
         tokenProgram: getNextAccount(),
         systemProgram: getNextAccount(),
      },
      data: getInitializeFaucetInstructionDataDecoder().decode(instruction.data),
   };
}
